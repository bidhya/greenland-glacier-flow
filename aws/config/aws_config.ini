# AWS-specific configuration for Greenland glacier flow processing
# This file contains AWS cloud service settings and preferences

[AWS_ACCOUNT]
# AWS account and access settings
aws_region = us-west-2
# aws_profile = glacier-processing  # Optional: AWS CLI profile to use
account_id = 425980623116  # Your AWS account ID

[STORAGE]
# S3 bucket configuration for data storage
# NOTE: Bucket must exist and user must have read/write access
# If bucket doesn't exist, ask admin to create or grant s3:CreateBucket permission
s3_bucket = greenland-glacier-data

# S3 output structure (matches local/HPC structure)
# Results organized as: s3://{bucket}/{s3_base_path}/{satellite}/{subfolders}/
# Example: s3://greenland-glacier-data/1_download_merge_and_clip/sentinel2/clipped/134_Arsuk/
s3_base_path = 1_download_merge_and_clip

# Subfolder structure (automatically created):
# For Sentinel-2: download/, clipped/, metadata/, template/
# For Landsat: {region_name}/, _reference/
# This mirrors local structure at /home/bny/greenland_glacier_flow/1_download_merge_and_clip/

[COMPUTE]
# Default compute settings for AWS services
instance_type = c5.large
spot_instances = false
max_vcpus = 256

# AWS Batch specific settings
batch_compute_environment = glacier-processing-env
batch_job_queue = glacier-processing-queue
batch_job_definition = satellite-processing

# ECS specific settings  
ecs_cluster = glacier-processing-cluster
ecs_task_definition = satellite-processing-task
ecs_subnets = subnet-12345,subnet-67890
ecs_security_groups = sg-processing

[FARGATE]
# AWS Fargate configuration for containerized processing
# Fargate provides serverless compute for ECS tasks
fargate_cluster_name = glacier-processing-cluster
fargate_task_definition = glacier-task
fargate_container_name = glacier-processing
fargate_ecr_repository = glacier-lambda
# Memory and CPU allocation (must be compatible pairs)
# Valid combinations: https://docs.aws.amazon.com/AmazonECS/latest/developerguide/task-cpu-memory-error.html
# Memory: 16GB (exceeds Lambda's 10GB baseline)
fargate_memory = 16384
# CPU: 4 vCPU
fargate_cpu = 4096
# Network configuration
fargate_subnets = subnet-09f06dee4cc5f7056,subnet-01bf0679b5ad5d4cf
fargate_security_groups = sg-0bf93d7503503ce92
# Container image
fargate_image = 123456789012.dkr.ecr.us-west-2.amazonaws.com/glacier-processing:latest

[NOTIFICATIONS]
# SNS topic for job notifications
sns_topic_arn = arn:aws:sns:us-east-1:123456789012:glacier-processing-notifications
# email_notifications = true

[SECURITY]
# IAM role for processing jobs
iam_execution_role = arn:aws:iam::123456789012:role/GlacierProcessingExecutionRole
iam_task_role = arn:aws:iam::123456789012:role/GlacierProcessingTaskRole

[COST_OPTIMIZATION]
# Cost management settings
use_spot_instances = false
spot_allocation_strategy = diversified
# budget_limit = 100  # Monthly budget limit in USD
# cost_alerts = true

[MONITORING]
# CloudWatch settings for monitoring
log_group = /aws/glacier-processing
log_retention_days = 30
enable_detailed_monitoring = false

[LAMBDA]
# AWS Lambda function configuration for satellite processing
# Validated through containerized deployment (January 2026)
function_name = glacier-processing
# Memory: 10240 MB (10 GB) - production setting for both satellites
# Sentinel-2: 96s runtime, 3.3GB peak memory, 11 files (510MB)
# Landsat: 17s runtime, 375MB peak memory, 5 files (2.9MB)
memory_size = 10240
# Timeout: 900 seconds (15 minutes)
timeout = 900
# Ephemeral storage: 10240 MB (10 GB /tmp storage)
ephemeral_storage = 10240
# Package type: Image (containerized deployment)
package_type = Image
handler = lambda_handler.handler

# Lambda deployment configuration
ecr_repository = glacier-lambda
ecr_image_tag = latest
ecr_image_uri = 425980623116.dkr.ecr.us-west-2.amazonaws.com/glacier-lambda:latest
dockerfile_path = aws/lambda/Dockerfile.lambda

# Runtime settings
python_version = 3.12
architecture = x86_64

[EXPERIMENTAL]
# Settings for experimental features
# Lambda containerized deployment is production-ready (January 2026)
# Validated: Both Sentinel-2 and Landsat processing working
enable_lambda_processing = true
enable_step_functions = false
# parallel_processing_regions = 4